{"ast":null,"code":"import _regeneratorRuntime from\"/home/edith/Desktop/PI/FT10-PI-Videogames/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/edith/Desktop/PI/FT10-PI-Videogames/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/edith/Desktop/PI/FT10-PI-Videogames/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _asyncToGenerator from\"/home/edith/Desktop/PI/FT10-PI-Videogames/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useState,useEffect,useRef}from'react';import{useSelector,useDispatch}from'react-redux';import'./MultiSelectGenre.css';import fetch from'node-fetch';import{saveNgGenSel,sendedForm}from'../../actions/actions';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function MultiSelectGenre(){var dispatch=useDispatch();function genObjFromArr(arr){var gen=[];for(var i=0;i<arr.length;i++){var obj={value:arr[i].name,label:arr[i].name};gen.push(obj);}return gen;}function getGenreAsync(){return _getGenreAsync.apply(this,arguments);}function _getGenreAsync(){_getGenreAsync=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,data,objArr;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"http://localhost:3001/genres\");case 2:response=_context.sent;_context.next=5;return response.json();case 5:data=_context.sent;objArr=genObjFromArr(data);return _context.abrupt(\"return\",objArr);case 8:case\"end\":return _context.stop();}}},_callee);}));return _getGenreAsync.apply(this,arguments);}var _useState=useState(false),_useState2=_slicedToArray(_useState,2),show=_useState2[0],setShow=_useState2[1];var genreopt=useRef([]);useEffect(function(){getGenreAsync().then(function(gen){genreopt.current=gen;//console.log(genreopt);\n}).then(function(){//console.log(genreopt);\nsetShow(true);}).catch(function(error){return console.log(error);});});// Estado de géneros seleccionados\nvar _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),sgenres=_useState4[0],setSgenres=_useState4[1];// selected genres\n// Quita género de la selección\nfunction removeItem(item){var newItems=sgenres.filter(function(e){return e!==item;});setSgenres(newItems);}// Cuando hace selección en desplegable lo seleciona/deselecciona\nfunction handleChange(e){var itemP=e.target.value;var hasItem=sgenres.includes(itemP);if(!hasItem){setSgenres([].concat(_toConsumableArray(sgenres),[itemP]));}else{removeItem(itemP);}}// Cuando hace click en el botón lo saca\nfunction handleClick(e){var itm=e.target.value;removeItem(itm);}//Cada vez que cambia un género guarda el estado en el store\nuseEffect(function(){dispatch(saveNgGenSel(sgenres));},[sgenres,dispatch]);var sended=useSelector(function(state){return state.sended;});// Una vez que guarda el formulario, manda lim\nuseEffect(function(){setSgenres([]);dispatch(sendedForm(false));},[sended,dispatch]);return/*#__PURE__*/_jsx(\"div\",{className:\"selgenfom\",children:!show?'...cargando géneros.':/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"select\",{name:\"genres\",placeholder:\"Plataformas...\",className:\"multselectgen\",value:'',onChange:handleChange,children:[/*#__PURE__*/_jsx(\"option\",{defaultValue:true,children:\"G\\xE9neros:\"}),genreopt.current&&genreopt.current.map(function(item,index){return/*#__PURE__*/_jsx(\"option\",{value:item.value,children:item.label},index);})]}),/*#__PURE__*/_jsx(\"div\",{className:\"gencont\",children:sgenres.map(function(item,index){return/*#__PURE__*/_jsx(\"button\",{className:\"selgenbtn\",value:item,onClick:handleClick,children:item},index);})})]})});}","map":{"version":3,"sources":["/home/edith/Desktop/PI/FT10-PI-Videogames/client/src/components/MultiSelectGenre/MultiSelectGenre.jsx"],"names":["React","useState","useEffect","useRef","useSelector","useDispatch","fetch","saveNgGenSel","sendedForm","MultiSelectGenre","dispatch","genObjFromArr","arr","gen","i","length","obj","value","name","label","push","getGenreAsync","response","json","data","objArr","show","setShow","genreopt","then","current","catch","error","console","log","sgenres","setSgenres","removeItem","item","newItems","filter","e","handleChange","itemP","target","hasItem","includes","handleClick","itm","sended","state","map","index"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport './MultiSelectGenre.css';\nimport fetch from 'node-fetch';\nimport {saveNgGenSel , sendedForm} from '../../actions/actions';\n\nexport default function MultiSelectGenre() {\n\n  const dispatch = useDispatch();\n\n  function genObjFromArr(arr) {\n    let gen = [];\n    for (let i = 0; i < arr.length; i++) {\n      let obj = { value: arr[i].name, label: arr[i].name };\n      gen.push(obj);\n    }\n    return gen;\n  }\n\n  async function getGenreAsync() {\n    let response = await fetch(\"http://localhost:3001/genres\");\n    let data = await response.json();\n    let objArr = genObjFromArr(data);\n    return objArr;\n  }\n\n  let [show, setShow] = useState(false);\n  const genreopt = useRef([]);\n\n  useEffect(() => {\n    getGenreAsync()\n      .then(gen => {\n        genreopt.current = gen;\n        //console.log(genreopt);\n      })\n      .then(() => {\n        //console.log(genreopt);\n        setShow(true);\n      })\n      .catch(error => console.log(error))\n  })\n\n  // Estado de géneros seleccionados\n  let [sgenres, setSgenres] = useState([]);// selected genres\n\n  // Quita género de la selección\n  function removeItem(item) {\n    let newItems = sgenres.filter(e => e !== item);\n    setSgenres(newItems);\n  }\n\n  // Cuando hace selección en desplegable lo seleciona/deselecciona\n  function handleChange(e) {\n    let itemP = e.target.value;\n    let hasItem = sgenres.includes(itemP);\n    if (!hasItem) {\n      setSgenres([...sgenres, itemP]);\n    } else {\n      removeItem(itemP);\n    }\n  }\n\n  // Cuando hace click en el botón lo saca\n  function handleClick(e) {\n    let itm = e.target.value;\n    removeItem(itm);\n  }\n\n  //Cada vez que cambia un género guarda el estado en el store\n  useEffect(() => {\n    dispatch(saveNgGenSel(sgenres));\n  }, [sgenres,dispatch]);\n\n  const sended = useSelector(state => state.sended);\n\n  // Una vez que guarda el formulario, manda lim\n  useEffect(() => {\n    setSgenres([]);\n    dispatch(sendedForm(false));\n  }, [sended,dispatch]);\n\n  return (\n    <div className=\"selgenfom\">\n      {!show ? '...cargando géneros.' :\n        <>\n          <select\n            name=\"genres\"\n            placeholder=\"Plataformas...\"\n            className=\"multselectgen\"\n            value={''}\n            onChange={handleChange}\n          >\n            <option defaultValue>Géneros:</option>\n            {genreopt.current && genreopt.current.map((item, index) => (\n              <option key={index} value={item.value}>{item.label}</option>\n            ))}\n          </select>\n          <div className=\"gencont\">\n            {sgenres.map((item, index) => (\n              <button className=\"selgenbtn\" value={item}\n                onClick={handleClick} key={index}>\n                {item}\n              </button>\n            ))}\n          </div>\n        </>\n      }\n    </div>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}